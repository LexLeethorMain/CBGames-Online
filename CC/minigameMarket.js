"use strict";(M={}).parent=Game.Objects.Bank,(M.parent.minigame=M).launch=function(){var g=this;g.name=g.parent.minigameName,g.init=function(e){g.goods={Farm:{name:"Cereals",symbol:"CRL",company:"Old Mills",desc:"<b>Old Mills</b> is a trusted staple of the grain industry. Finding their roots in humble pioneer farms centuries ago and honing their know-how ever since, the Old Mills organic crops have reached a standard of quality that even yours struggle to equal."},Mine:{name:"Chocolate",symbol:"CHC",company:"Cocoa Excavations",desc:"<b>Cocoa Excavations</b> is an international chocolate mining venture whose extraction sites always seem, somehow, to pop up in war-torn countries. Their high-grade chocolate is renowned the world over and has even been marketed, to some success, as suitable gems for engagement rings."},Factory:{name:"Butter",symbol:"BTR",company:"Bovine Industries",desc:'<b>Bovine Industries</b> is a formerly-agricultural conglomerate that now deals in mechanized dairy mass production. Whistleblowers have drawn attention to the way the milk cows employed by this company are treated, describing it as "not quite cruel or anything, but definitely unusual".'},Bank:{name:"Sugar",symbol:"SUG",company:"Candy Trust",desc:"The <b>Candy Trust</b> is a corporate banking group backed by, and specialized in, the trade of high-grade sugar. The origin of said sugar is legally protected by an armada of lawyers, though some suspect they secretly scrape it off of the bank bills coming in before processing it."},Temple:{name:"Nuts",symbol:"NUT",company:"Hazel Monastery",desc:"Hidden between hills and fog somewhere, the secretive <b>Hazel Monastery</b> has, for centuries, maintained nut crops of the highest quality. The monastery nuts are carefully tended to, harvested and shelled by its monks, who are all required to take a vow of nut allergy as a lifelong test of piety."},"Wizard tower":{name:"Salt",symbol:"SLT",company:"Wacky Reagants",desc:"Salt is a versatile substance, with properties both mundane and mystical. This is why the bearded crackpots at <b>Wacky Reagants</b> have perfected the art of turning magic powder into salt, which is then sold to anyone promising to put it to good use - whether it be warding off banshees and ghouls or seasoning a Sunday roast."},Shipment:{name:"Vanilla",symbol:"VNL",company:"Cosmic Exports",desc:"After the news broke of vanilla not being native to Earth, <b>Cosmic Exports</b> was the first company to discover its true origin planet - and has struck an exclusive deal with its tentacled inhabitants to ship its valuable, unadulterated beans all over the local quadrant."},"Alchemy lab":{name:"Eggs",symbol:"EGG",company:"Organic Gnostics",desc:"At <b>Organic Gnostics</b>, an egg is seen as a promise. A promise of life and nourishment, of infinite potential, of calcium and protein. An egg can become many things... especially when you're properly funded and don't believe there's room in science for rules or ethics."},Portal:{name:"Cinnamon",symbol:"CNM",company:"Dimensional Exchange",desc:"The <b>Dimensional Exchange</b> employs a vast team of ragtag daredevils to dive into dangerous underworlds in search of strange native spices. Chief among those is cinnamon, a powder so delicious its true nature can only be unspeakably abominable."},"Time machine":{name:"Cream",symbol:"CRM",company:"Precision Aging",desc:"Once specialized in cosmetics for the elderly, the eggheads at <b>Precision Aging</b> have repurposed their timeshift technology and developed a process allowing them to accelerate, slow down, and even reverse the various phase changes of milk. Their flagship offering, whole cream, is said to be within 0.002% of theoretical ripening optimums."},"Antimatter condenser":{name:"Jam",symbol:"JAM",company:"Pectin Research",desc:"<b>Pectin Research</b> is a military-backed laboratory initially created with the aim of enhancing and miniaturizing army rations, but now open for public bulk trading. It has recently made forays in the field of highly-concentrated fruit jams, available in a variety of flavors."},Prism:{name:"White chocolate",symbol:"WCH",company:"Dazzle Corp Ltd.",desc:"What was once two college kids messing around with mirrors in their dad's garage is now a world-famous megacorporation. <b>Dazzle Corp</b>'s groundbreaking experiments in photonic annealing have led to the creation years ago of a new kind of matter, once derided as impossible by physicists and cooks alike: white chocolate."},Chancemaker:{name:"Honey",symbol:"HNY",company:"Prosperity Hive",desc:"The folks at <b>Prosperity Hive</b> deal in honey, and it's always worked for them. With a work culture so relaxed you're almost tempted to ditch the cookie business and join them, these people have little in common with the proverbial busy bee - though their rates do sting quite a bit."},"Fractal engine":{name:"Cookies",symbol:"CKI",company:"Selfmade Bakeries",desc:"Interesting. It appears there's still a company out there trying to sell cookies even with your stranglehold on the market. No matter - you figure <b>Selfmade Bakeries</b>' largely inferior product will make decent fodder for the mouse traps in your factories."},"Javascript console":{name:"Recipes",symbol:"RCP",company:"Figments Associated",desc:"In a post-material world, the market of ideas is where value is created. <b>Figments Associated</b> understands that, and is the prime designer (and patenter) of baking recipes, ingredient nomenclature, custom cooking procedures, and other kitchen processes."},Idleverse:{name:"Subsidiaries",symbol:"SBD",company:"Polyvalent Acquisitions",desc:"Avoid the uncouth nastiness of mass layoffs and hostile takeovers by delegating the purchase, management, and eventual dissolution of other companies to the boys at <b>Polyvalent Acquisitions</b>. Let 'em deal with it!"},"Cortex baker":{name:"Publicists",symbol:"PBL",company:"Great Minds",desc:"Get those juices flowing: from market research to advertising, the think tanks at <b>Great Minds</b> will lend their talents to the highest bidder. It's intellectual property on tap."},You:{name:"%1",symbol:"YOU",company:"%1's Bakery",desc:"That's right! Your transcendental business skills are so influential, so universally resounding, that you've become a publicly traded good yourself - you're the best <b>%1's Bakery</b> has to offer. Don't disappoint your shareholders, there's a price on your head! Invest in yourself NOW!"}},g.goodsById=[];var o=0;for(s in g.goods){var a=g.goods[s];a.id=o,a.hidden=!1,a.active=!1,a.last=0,a.building=Game.Objects[s],a.stock=0,a.mode=0,a.dur=0,a.prev=0,a.val=1,a.vals=[a.val],a.d=0,(g.goodsById[o]=a).icon=[a.building.iconColumn,33],a.name=loc(FindLocStringByPart("STOCK "+(a.id+1)+" TYPE")),a.company=loc(FindLocStringByPart("STOCK "+(a.id+1)+" NAME")),a.symbol=loc(FindLocStringByPart("STOCK "+(a.id+1)+" LOGO")),o++}g.goodTooltip=function(i){return function(){var e=g.goodsById[i],o=g.goodDelta(i),a=g.getGoodPrice(e),t=(icon=e.icon||[0,0],e.name.replace("%1",Game.bakeryName));return'<div style="padding:8px 4px;min-width:350px;" id="tooltipMarketGood"><div class="icon" style="float:left;margin-left:-8px;margin-top:-8px;background-position:'+48*-icon[0]+"px "+48*-icon[1]+'px;"></div><div class="name">'+t+' <span style="font-size:12px;opacity:0.8;">('+loc("from %1",'<span style="font-variant:small-caps;">'+e.company.replace("%1",Game.bakeryName)+"</span>")+')</span> <span class="bankSymbol">'+e.symbol+' <span class="bankSymbolNum'+(0<=o?" bankSymbolUp":o<0?" bankSymbolDown":"")+'">'+o+(o==Math.floor(o)?".00":10*o==Math.floor(10*o)?"0":"")+'%</span></span></div><div class="line"></div>'+(EN?'<div class="description"><q>'+e.desc.replace("%1",Game.bakeryName)+'</q><div class="line">':"")+'</div><div style="font-size:11px;">&bull; <div class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -16px -14px;vertical-align:middle;background-position:'+48*-icon[0]+"px "+48*-icon[1]+'px;"></div> '+loc("%1: currently worth <b>$%2</b> per unit.",[t,Beautify(a,2)])+"<br>&bull; "+loc("You currently own %1 (worth <b>$%2</b>).",['<div class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -16px -14px;vertical-align:middle;background-position:'+48*-icon[0]+"px "+48*-icon[1]+'px;"></div> <b>'+Beautify(e.stock)+"</b>x "+t,Beautify(a*e.stock,2)])+"<br>&bull; "+loc("Your warehouses can store up to %1.",'<div class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -16px -14px;vertical-align:middle;background-position:'+48*-icon[0]+"px "+48*-icon[1]+'px;"></div> <b>'+Beautify(g.getGoodMaxStock(e))+"</b>x "+t)+"<br>&bull; "+loc("You may increase your storage space by upgrading your offices and by buying more %1. You also get %2 extra storage space per %3 level (currently: <b>+%4</b>).",['<div class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -16px -14px;vertical-align:middle;background-position:'+48*-e.building.iconColumn+'px 0px;"></div> '+e.building.plural,10,e.building.single,10*e.building.level])+"<br>&bull; "+loc("The average worth of this stock and how high it can peak depends on the building it is tied to, along with the level of your %1.",'<div class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -16px -14px;vertical-align:middle;background-position:-720px 0px;"></div> '+Game.Objects.Bank.plural)+'</div><div style="font-size:11px;opacity:0.5;margin-top:3px;">'+loc("%1 the hide button to toggle all other stocks.",loc("Shift-click"))+"</div></div></div>"}},g.tradeTooltip=function(l,r){return function(){var e=g.goodsById[l],o=(e.icon,g.getGoodPrice(e)),a=Game.cookiesPsRawHighest*o,t=0<r,i=1,n=e.stock,s=g.getGoodMaxStock(e);return t&&(i*=1+20*Math.pow(.95,g.brokers)*.01),a*=i,1e4==r?r=Math.floor(Game.cookies/a):-1e4==r&&(r=e.stock),r=Math.abs(r),t&&(r=Math.min(r,s-n)),t||(r=Math.min(r,n)),'<div style="padding:8px 4px;min-width:128px;text-align:center;font-size:11px;" id="tooltipMarketTrade"><div style="font-size:9px;opacity:0.6;">'+cap(loc("stock:"))+" <b"+(t||0!=n?"":' class="red"')+">"+Beautify(n)+"</b>/<b"+(t&&s<=n?' class="red"':"")+">"+Beautify(s)+"</b></div>"+(e.prev?'<div class="line"></div><div style="font-size:9px;opacity:0.6;font-weight:bold;">'+loc("last bought at<br>$%1 each",Beautify(e.prev,2))+"</div>":"")+'<div class="line"></div><div>'+(t?loc("Buy"):loc("Sell"))+" <b>"+Beautify(r)+'</b>x <div class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -16px -14px;vertical-align:middle;background-position:'+48*-e.icon[0]+"px "+48*-e.icon[1]+'px;"></div> '+e.name.replace("%1",Game.bakeryName)+"</div><div>"+loc("for $%1 each",Beautify(o,2))+"</div>"+(1<i?'<div style="font-size:9px;opacity:0.6;">('+loc("+<b>%1%</b> overhead",Beautify(100*(i-1),2))+")</div>":"")+'<div class="line"></div><div style="font-size:9px;opacity:0.6;font-weight:bold;">'+(t?loc("you spend:"):loc("you earn:"))+'</div><div><b class="hasTinyCookie '+(r<=0?"gray":Game.cookies>=a*r||!t?"green":"red")+'">'+Beautify(a*r)+"</b></div>"+(0<r?'<div style="font-size:9px;opacity:0.6;font-weight:bold;">($'+Beautify(o*i*r,2)+')</div><div style="font-size:9px;opacity:0.6;font-weight:bold;">('+loc("%1 of CpS",Game.sayTime(o*i*r*Game.fps,-1))+")</div>":"")+(1==e.last&&!t||2==e.last&&t?'<div class="line"></div><div class="red">'+loc("You cannot buy and sell this stock in the same tick.")+"</div>":"")+"</div>"}},g.goodDelta=function(e,o){var o=o||0,a=0;return(e=g.goodsById[e]).vals.length>=2+o&&(a=e.vals[0+o]/e.vals[1+o]-1),Math.floor(1e4*a)/100},g.getGoodMaxStock=function(e){var o=0;return 0<g.officeLevel&&(o+=25),1<g.officeLevel&&(o+=50),2<g.officeLevel&&(o+=75),3<g.officeLevel&&(o+=100),Math.ceil(e.building.highest*(4<g.officeLevel?1.5:1)+o+10*e.building.level)},g.getGoodPrice=function(e){return e.val},g.buyGood=function(e,o){var e=g.goodsById[e],a=g.getGoodPrice(e),t=Game.cookiesPsRawHighest*a,i=1+20*Math.pow(.95,g.brokers)*.01;if(t*=i,1e4==o&&(o=Math.floor(Game.cookies/t)),0<(o=Math.min(o,g.getGoodMaxStock(e)-e.stock))&&2!=e.last&&Game.cookies>=t*o&&e.stock+o<=g.getGoodMaxStock(e)){86400<=a*i*o&&Game.Win("Buy buy buy"),g.profit-=a*i*o,Game.Spend(t*o),e.stock+=o;for(var n=1e4,s=0;s<g.goodsById.length;s++){var l=g.goodsById[s],n=Math.min(n,l.stock);1e3<=l.stock&&Game.Win("Full warehouses")}return 100<=n&&Game.Win("Rookie numbers"),500<=n&&Game.Win("No nobility in poverty"),e.last=1,e.prev=a,PlaySound("snd/cashOut.mp3",.4),!0}return!1},g.sellGood=function(e,o){var a,e=g.goodsById[e];return 1e4==o&&(o=e.stock),0<(o=Math.min(o,e.stock))&&1!=e.last&&0<e.stock&&(86400<=(a=g.getGoodPrice(e))*o&&Game.Win("Make my day"),g.profit+=a*o,0<g.profit&&Game.Win("Initial public offering"),1e7<=g.profit&&Game.Win("Liquid assets"),31536e3<=g.profit&&Game.Win("Gaseous assets"),Game.cookies+=Game.cookiesPsRawHighest*a*o,Game.cookiesEarned=Math.max(Game.cookies,Game.cookiesEarned),e.stock-=o,e.last=2,PlaySound("snd/cashIn.mp3",.4),!0)},g.getRestingVal=function(e){return 10+10*e+(Game.Objects.Bank.level-1)},g.updateGoodStyle=function(e){(e=g.goodsById[e]).active?(e.l.style.display="inline-block",e.hidden?(e.l.classList.add("bankHidden"),e.graphIconL.style.display="none"):(e.l.classList.remove("bankHidden"),e.graphIconL.style.display="block")):(e.l.style.display="none",e.graphIconL.style.display="none")},g.officeLevel=0,g.offices=[{name:loc("Credit garage"),icon:[0,33],cost:[100,2],desc:EN?"This is your starting office.":loc("This is your office.")+"<br>"+loc("Upgrading will grant you:")+"<br><b>\x3c!--&bull; "+loc("+1 opportunity slot")+"<br>--\x3e&bull; "+loc("+%1 warehouse space for all goods",25)+"</b>"},{name:loc("Tiny bank"),icon:[9,33],cost:[200,4],desc:loc("This is your office.")+"<br>"+loc("Upgrading will grant you:")+"<br><b>&bull; "+loc("+1 loan slot")+"<br>&bull; "+loc("+%1 warehouse space for all goods",50)+"</b>"},{name:loc("Loaning company"),icon:[10,33],cost:[350,8],desc:loc("This is your office.")+"<br>"+loc("Upgrading will grant you:")+"<br>\x3c!--<b>&bull; "+loc("+1 opportunity slot")+"<br>--\x3e&bull; "+loc("+%1 warehouse space for all goods",75)+"</b>"},{name:loc("Finance headquarters"),icon:[11,33],cost:[500,10],desc:loc("This is your office.")+"<br>"+loc("Upgrading will grant you:")+"<br><b>&bull; "+loc("+1 loan slot")+"<br>&bull; "+loc("+%1 warehouse space for all goods",100)+"</b>"},{name:loc("International exchange"),icon:[12,33],cost:[700,12],desc:loc("This is your office.")+"<br>"+loc("Upgrading will grant you:")+"<br><b>&bull; "+loc("+1 loan slot")+"<br>\x3c!--&bull; "+loc("+1 opportunity slot")+"<br>--\x3e&bull; "+loc("+%1% base warehouse space for all goods",50)+"</b>"},{name:loc("Palace of Greed"),icon:[18,33],cost:0,desc:loc("This is your office.")+"<br>"+loc("It is fully upgraded. Its lavish interiors, spanning across innumerable floors, are host to many a decadent party, owing to your nigh-unfathomable wealth.")}],g.officeTooltip=function(){return function(){var e=g.offices[g.officeLevel],o=e.icon||[0,0];return'<div style="padding:8px 4px;min-width:350px;" id="tooltipMarketOffice"><div class="icon" style="float:left;margin-left:-8px;margin-top:-8px;background-position:'+48*-o[0]+"px "+48*-o[1]+'px;"></div><div class="name">'+e.name+' <span style="font-size:11px;opacity:0.6;">['+loc("Level %1 offices",g.officeLevel+1)+']</span></div><div class="line"></div><div class="description" style="font-size:11px;">'+e.desc+"</div>"+(e.cost?'<div class="line"></div><div style="font-size:11px;padding-left:24px;position:relative;"><div id="bankOfficeIcon" class="icon" style="position:absolute;left:0px;top:6px;pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -16px -14px;vertical-align:middle;background-position:-528px 0px;"></div>'+loc("Upgrading will cost you %1.",'<b class="'+(Game.Objects.Cursor.amount>=e.cost[0]?"green":"red")+'">'+e.cost[0]+" "+Game.Objects.Cursor.plural+"</b>")+"<br>"+loc("Upgrading requires %1.",'<b class="'+(Game.Objects.Cursor.level>=e.cost[1]?"green":"red")+'">'+loc("Level %1 %2",[e.cost[1],Game.Objects.Cursor.plural])+"</b>")+"</div>":"")+"</div>"}},g.brokers=0,g.getMaxBrokers=function(){return Math.ceil(Game.Objects.Grandma.highest/10+Game.Objects.Grandma.level)},g.getBrokerPrice=function(){return 60*Game.cookiesPsRawHighest*20},g.brokersTooltip=function(){return function(){var e=[1,33];return'<div style="padding:8px 4px;min-width:350px;" id="tooltipMarketBrokers"><div class="icon" style="float:left;margin-left:-8px;margin-top:-8px;background-position:'+48*-e[0]+"px "+48*-e[1]+'px;"></div><div class="name">'+(EN?'Stockbrokers <span style="font-size:11px;opacity:0.6;">(you have '+Beautify(g.brokers)+")</span>":loc("Brokers:")+" "+Beautify(g.brokers))+'</div><div class="line"></div><div class="description" style="font-size:11px;">'+loc("A nice broker to trade more cookies.")+"<br>&bull; "+loc("Buying goods normally incurs overhead costs of <b>%1% extra</b>. Each broker you hire reduces that cost by <b>%2%</b>.",[20,5])+"<br>&bull; "+loc("Current overhead costs thanks to your brokers: <b>+%1%</b>",Beautify(20*Math.pow(.95,g.brokers),2))+"<br>&bull; "+loc("Buying a broker costs %1 of CpS (that's $%2).",['<b class="hasTinyCookie '+(Game.cookies>=g.getBrokerPrice()?"green":"red")+'">'+loc("%1 minute",LBeautify(20))+"</b>",1200])+"<br>&bull; "+loc("Maximum number of brokers you can own: %1 (the highest amount of grandmas you've owned this run, divided by 10, plus your grandma level)",'<b class="'+(g.brokers<g.getMaxBrokers()?"green":"red")+'">'+Beautify(g.getMaxBrokers())+"</b>")+"<br><q>"+loc("Brokers are Wall Street-class grandmas versed in the ways of finance. Stockbroker grandmas work hard and play hard, and will fight telephone in hand to get your clients the best possible deals - with a sizeable profit margin for you, of course.")+'</q><div class="line"></div><div style="font-size:11px;text-align:center;">'+loc("Hiring a new broker will cost you %1.",'<b class="hasTinyCookie '+(Game.cookies>=g.getBrokerPrice()?"green":"red")+'">'+loc("%1 cookie",LBeautify(g.getBrokerPrice()))+"</b>")+"</div></div></div>"}},g.loanTypes=[[loc("a modest loan"),1.5,120,.25,240,.2,loc("Buy that vintage car you've always wanted. Just pay us back.")],[loc("a pawnshop loan"),2,.67,.1,40,.4,loc("Bad credit? No problem. It's your money, and you need it now.")],[loc("a retirement loan"),1.2,2880,.8,7200,.5,loc("Finance your next house, boat, spouse, etc. You've earned it.")]],g.loanTooltip=function(o){return function(){var e=g.loanTypes[o-1];return'<div style="padding:8px 4px;min-width:350px;" id="tooltipMarketLoan"><div class="name">'+loc("Take out %1",e[0])+'</div><div class="line"></div><div class="description" style="font-size:11px;">'+loc("By taking this loan, you will get %1 CpS for the next %2.",['<b class="green">+'+Math.round(100*(e[1]-1))+"%</b>","<b>"+Game.sayTime(60*e[2]*Game.fps)+"</b>"])+"<br>"+loc("However, you will get %1 CpS for the next %2 after that.",['<b class="red">'+Math.round(100*(e[3]-1))+"%</b>","<b>"+Game.sayTime(60*e[4]*Game.fps)+"</b>"])+loc("You must also pay an immediate downpayment of %1 (<b>%2%</b> of your current bank).",['<b class="hasTinyCookie red">'+Beautify(Game.cookies*e[5])+"</b>",100*e[5]])+"<q>"+e[6]+"</q></div>"}},g.takeLoan=function(e,o){var a=g.loanTypes[e-1];if(o)Game.gainBuff("loan "+e+" interest",60*a[4],a[3]),Game.Notify(loc("Loan over"),loc("Your loan has expired, and you must now repay the interest."),[1,33]);else{if(Game.hasBuff("Loan "+e)||Game.hasBuff("Loan "+e+" (interest)"))return!1;Game.Spend(Game.cookies*a[5]),Game.gainBuff("loan "+e,60*a[2],a[1])}return!0},Game.takeLoan=g.takeLoan,g.getOppSlots=function(){var e=0;return 0<g.officeLevel&&e++,2<g.officeLevel&&e++,4<g.officeLevel&&e++,e},g.oppTooltip=function(){return function(){return'<div style="padding:8px 4px;min-width:350px;" id="tooltipMarketOpp"><div class="name">Generate opportunity</div><div class="line"></div><div class="description" style="font-size:11px;">Pressing this button gives you up to 3 possible actions to choose from, depending on your office level.<br>These actions will let you manipulate the stock market to some degree, though some are riskier than others.<br>You may only generate an opportunity once an hour, though this can be refreshed with a sugar lump.</div>'}},g.refillTooltip=function(){return'<div style="padding:8px;width:300px;font-size:11px;text-align:center;" id="tooltipRefill">'+loc("Click to refill your opportunity timer (and give a quick burst to your economy) for %1.",'<span class="price lump">'+loc("%1 sugar lump",LBeautify(1))+"</span>")+(Game.canRefillLump()?"<br><small>("+loc("can be done once every %1",Game.sayTime(Game.getLumpRefillMax(),-1))+")</small>":'<br><small class="red">('+loc("usable again in %1",Game.sayTime(Game.getLumpRefillRemaining()+Game.fps,-1))+")</small>")+"</div>"};for(var t="",i=(t=(t=t+("<style>#bankBG{background:url("+Game.resPath+"img/shadedBorders.png),url("+Game.resPath+"img/BGmarket.jpg);background-size:100% 100%,auto;position:absolute;left:0px;right:0px;top:0px;bottom:16px;}#bankContent{position:relative;box-sizing:border-box;padding:4px;text-align:center;}.bankGood{margin:2px;display:inline-block;width:156px;text-align:center;position:relative;left:0px;top:0px;right:0px;box-sizing:border-box;box-shadow:0px 0px 0px 1px rgba(255,255,255,0.1), 2px 2px 4px rgba(0,0,0,0.5) inset;background:rgba(0,0,0,0.9);color:rgba(255,255,255,0.7);}.bankHidden{opacity:0.75;background:transparent;box-shadow:none;}.bankButton{cursor:pointer;opacity:0.8;color:#94cd50;font-weight:bold;font-size:10px;border:1px solid #999;border-color:#94cd50 #1b7a2f #1b7a2f #94cd50;padding:2px 6px;margin:0px 1px 1px 0px;display:inline-block;}.bankButtonBuy{color:#a358ff;border-color:#a358ff #3a52bc #3a52bc #a358ff;}.bankButtonSell{color:#94cd50;border-color:#94cd50 #1b7a2f #1b7a2f #94cd50;}.bankButton:hover{opacity:1;}.bankButton:active{color:#fff;}.bankButtonOff{color:#999;border-color:#999 #666 #666 #999;opacity:0.6;}.bankSymbol{font-weight:bold;font-size:10px;display:inline-block;padding:2px 4px;background:#333;text-shadow:0px 1px #000;}.bankSymbolNum{font-weight:normal;}.bankSymbolNum:after{content:'=';}.bankSymbolUp{color:#73f21e;}.bankSymbolUp:after{content:'▲';}.bankSymbolDown{color:#f21e3c;}.bankSymbolDown:after{content:'▼';}#bankGraphBox{background:#fff;position:relative;z-index:5;overflow:hidden;height:300px;}.bankGraphIcon{position:absolute;right:-24px;top:-24px;z-index:10;transform:scale(0);transition:transform 0.3s;}.bankViewHide{position:absolute;z-index:10;width:14px;height:14px;background:url("+Game.resPath+"img/tinyEyeOn.png);top:1px;right:4px;opacity:0.8;}.bankHidden .bankViewHide{background:url("+Game.resPath)+'img/tinyEyeOff.png);}.bankSimpleButton{font-weight:bold;font-size:10px;cursor:pointer;text-decoration:underline;color:rgba(255,255,255,0.9);text-shadow:0px 1px #000;}.bankSimpleButton:hover{color:#fff;opacity:1;}.bankSimpleButton:active{opacity:0.5;}</style><div id="bankBG"></div><div id="bankContent">')+'<div id="bankHeader" style="z-index:10;position:relative;"><div><div style="padding:1px 4px;font-size:10px;color:rgba(255,255,255,0.5);">'+(EN?'Profits: <span id="bankBalance">$0</span>. All prices are in <b style="color:#fff;">$</b>econds of your highest raw cookies per second.':loc("Profits: %1. All prices are in $econds of your highest raw cookies per second.",'<span id="bankBalance">$0</span>'))+' <span id="bankNextTick"></span></div><div id="bankOffice" style="display:inline-block;padding:0px 4px;" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.officeTooltip()","this")+'><div id="bankOfficeIcon" class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -12px -14px;vertical-align:middle;background-position:'+-0+"px "+-1584+'px;"></div><span id="bankOfficeName" class="bankSymbol" style="width:128px;"></span><div class="bankButton bankButtonBuy bankButtonOff" id="bankOfficeUpgrade">-</div></div><div id="bankBrokers" style="display:inline-block;padding:0px 4px;" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.brokersTooltip()","this")+'><div id="bankBrokersIcon" class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -12px -14px;vertical-align:middle;background-position:'+-48+"px "+-1584+'px;"></div><span id="bankBrokersText" class="bankSymbol" style="width:96px;">'+(EN?"no brokers":loc("Brokers:")+" 0")+'</span><div class="bankButton bankButtonBuy bankButtonOff" id="bankBrokersBuy">'+loc("Hire")+'</div></div><div style="display:inline-block;padding:0px 4px;"><div id="bankLoan1" style="display:none;" class="bankButton bankButtonSell bankButtonOff" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.loanTooltip(1)","this")+">"+(EN?"1st loan":loc("Loan #%1",1))+'</div><div id="bankLoan2" style="display:none;" class="bankButton bankButtonSell bankButtonOff" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.loanTooltip(2)","this")+">"+(EN?"2nd loan":loc("Loan #%1",2))+'</div><div id="bankLoan3" style="display:none;" class="bankButton bankButtonSell bankButtonOff" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.loanTooltip(3)","this")+">"+(EN?"3rd loan":loc("Loan #%1",3))+"</div></div></div>",loc("Buy")),n=loc("Sell"),s=0;s<g.goodsById.length;s++)t+='<div class="bankGood" id="bankGood-'+(r=g.goodsById[s]).id+'"><div '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.goodTooltip("+r.id+")","this")+'><div class="icon" style="z-index:20;pointer-events:none;position:absolute;left:0px;top:0px;transform:scale(0.5);margin:-16px -16px;background-position:'+48*-r.icon[0]+"px "+48*-r.icon[1]+'px;"></div><div class="bankSymbol" style="margin:1px 0px;display:block;padding:2px 0px;width:100%;overflow:hidden;white-space:nowrap;">'+r.symbol+' <span id="bankGood-'+r.id+'-sym" class="bankSymbolNum">-.--%</span></div><div class="bankViewHide bankSimpleButton" id="bankGood-'+r.id+'-viewHide"></div><div class="bankSymbol" style="margin:1px 0px;display:block;font-size:10px;width:100%;background:linear-gradient(to right,transparent,#333,#333,transparent);padding:2px 0px;overflow:hidden;white-space:nowrap;">'+loc("value:")+' <span style="font-weight:bold;color:#fff;" id="bankGood-'+r.id+'-val">-</span></div><div class="bankSymbol" style="margin:1px 0px;display:block;font-size:10px;width:100%;background:linear-gradient(to right,transparent,#333,#333,transparent);padding:2px 0px;overflow:hidden;white-space:nowrap;" id="bankGood-'+r.id+'-stockBox">'+loc("stock:")+' <span style="font-weight:bold;" id="bankGood-'+r.id+'-stock">-</span><span style="font-weight:bold;" id="bankGood-'+r.id+'-stockMax">/-</span></div></div><div style="position:relative;white-space:nowrap;"><div style="padding:3px 2px;width:22px;'+(4<i.length||4<n.length?"display:block;padding:0px;width:100%;":"")+'" class="bankSymbol">'+i+'</div><div class="bankButton bankButtonBuy" id="bankGood-'+r.id+'_1" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.tradeTooltip("+r.id+",1)","this")+'>1</div><div class="bankButton bankButtonBuy" id="bankGood-'+r.id+'_10" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.tradeTooltip("+r.id+",10)","this")+'>10</div><div class="bankButton bankButtonBuy" id="bankGood-'+r.id+'_100" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.tradeTooltip("+r.id+",100)","this")+'>100</div><div style="min-width:28px;" class="bankButton bankButtonBuy" id="bankGood-'+r.id+'_Max" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.tradeTooltip("+r.id+",10000)","this")+">"+cap(loc("max"))+'</div><br><div style="padding:3px 2px;width:22px;'+(4<i.length||4<n.length?"display:block;padding:0px;width:100%;":"")+'" class="bankSymbol">'+n+'</div><div class="bankButton bankButtonSell" id="bankGood-'+r.id+'_-1" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.tradeTooltip("+r.id+",-1)","this")+'>1</div><div class="bankButton bankButtonSell" id="bankGood-'+r.id+'_-10" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.tradeTooltip("+r.id+",-10)","this")+'>10</div><div class="bankButton bankButtonSell" id="bankGood-'+r.id+'_-100" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.tradeTooltip("+r.id+",-100)","this")+'>100</div><div style="min-width:28px;" class="bankButton bankButtonSell" id="bankGood-'+r.id+'_-All" '+Game.getDynamicTooltip("Game.ObjectsById["+g.parent.id+"].minigame.tradeTooltip("+r.id+",-10000)","this")+">"+cap(loc("all"))+"</div></div></div>";for(e.innerHTML=t+='</div><div id="bankGraphBox"></div></div>',t="",t+='<div style="position:absolute;left:2px;top:2px;z-index:10;"><div id="bankGraphLines" class="bankSimpleButton" style="background:rgba(0,0,0,0.5);padding:2px;border-radius:4px;">'+loc("Line style")+'</div><div id="bankGraphCols" class="bankSimpleButton" style="background:rgba(0,0,0,0.5);padding:2px;border-radius:4px;">'+loc("Color mode")+"</div>"+(Game.sesame?'<div id="bankCheatSpeed" class="bankSimpleButton" style="background:rgba(0,0,0,0.5);padding:2px;border-radius:4px;">'+loc("Toggle speed")+"</div>":"")+'</div><div style="font-family:Arial Black;font-weight:40px;letter-spacing:2px;opacity:0.15;font-weight:bold;position:absolute;left:6px;bottom:6px;z-index:10;pointer-events:none;">DOUGH JONES INDEX</div>',s=0;s<g.goodsById.length;s++)t+='<div id="bankGood-'+(r=g.goodsById[s]).id+'-graphIcon" class="icon bankGraphIcon" style="pointer-events:none;transform:scale(0.5);background-position:'+48*-r.icon[0]+"px "+48*-r.icon[1]+'px;"></div>';l("bankGraphBox").innerHTML=t,(e=document.createElement("canvas")).id="bankGraph",e.style.marginLeft="-14px",e.width=64,e.height=64,l("bankGraphBox").appendChild(e),g.graph=e,g.graphCtx=g.graph.getContext("2d",{alpha:!1}),AddEvent(l("bankGraphLines"),"click",function(e){0==g.graphLines?g.graphLines=1:g.graphLines=0,g.toRedraw=2,PlaySound("snd/tick.mp3")}),AddEvent(l("bankGraphCols"),"click",function(e){0==g.graphCols?g.graphCols=1:g.graphCols=0,g.setCols(),g.toRedraw=2,PlaySound("snd/tick.mp3")}),l("bankCheatSpeed")&&AddEvent(l("bankCheatSpeed"),"click",function(e){60==g.secondsPerTick?g.secondsPerTick=.1:g.secondsPerTick=60,g.toRedraw=2,PlaySound("snd/tick.mp3")}),AddEvent(l("bankOfficeUpgrade"),"click",function(e){var o=g.offices[g.officeLevel];o.cost&&Game.Objects.Cursor.amount>=o.cost[0]&&Game.Objects.Cursor.level>=o.cost[1]&&(Game.Objects.Cursor.sacrifice(o.cost[0]),g.officeLevel+=1,g.officeLevel>=g.offices.length-1&&Game.Win("Pyramid scheme"),PlaySound("snd/cashIn2.mp3",.6),Game.SparkleOn(e.target))}),AddEvent(l("bankBrokersBuy"),"click",function(e){g.brokers<g.getMaxBrokers()&&Game.cookies>=g.getBrokerPrice()&&(Game.Spend(g.getBrokerPrice()),g.brokers+=1,PlaySound("snd/cashIn2.mp3",.6),Game.SparkleOn(e.target))}),AddEvent(l("bankLoan1"),"click",function(e){g.takeLoan(1)&&(PlaySound("snd/cashIn2.mp3",.6),Game.SparkleOn(e.target))}),AddEvent(l("bankLoan2"),"click",function(e){g.takeLoan(2)&&(PlaySound("snd/cashIn2.mp3",.6),Game.SparkleOn(e.target))}),AddEvent(l("bankLoan3"),"click",function(e){g.takeLoan(3)&&(PlaySound("snd/cashIn2.mp3",.6),Game.SparkleOn(e.target))});for(var r,s=0;s<g.goodsById.length;s++)(r=g.goodsById[s]).l=l("bankGood-"+r.id),r.symbolNumL=l("bankGood-"+r.id+"-sym"),r.valL=l("bankGood-"+r.id+"-val"),r.stockBoxL=l("bankGood-"+r.id+"-stockBox"),r.stockL=l("bankGood-"+r.id+"-stock"),r.stockMaxL=l("bankGood-"+r.id+"-stockMax"),r.viewHideL=l("bankGood-"+r.id+"-viewHide"),r.graphIconL=l("bankGood-"+r.id+"-graphIcon"),AddEvent(l("bankGood-"+s),"mouseover",function(o){return function(e){g.hoverOnGood!=o&&(g.hoverOnGood=o,g.toRedraw=2)}}(s)),AddEvent(l("bankGood-"+s),"mouseout",function(o){return function(e){g.hoverOnGood==o&&(g.hoverOnGood=-1,g.toRedraw=2)}}(s)),AddEvent(l("bankGood-"+s+"-viewHide"),"click",function(t){return function(e){if(Game.keys[16])for(var o=g.goodsById[t].hidden,a=0;a<g.goodsById.length;a++)g.goodsById[a].hidden=a==t?!o:!!o,g.updateGoodStyle(a);else g.goodsById[t].hidden?g.goodsById[t].hidden=!1:g.goodsById[t].hidden=!0,g.updateGoodStyle(t);g.checkGraphScale(),g.toRedraw=2,PlaySound("snd/tick.mp3")}}(s)),AddEvent(l("bankGood-"+s+"_1"),"click",function(o){return function(e){g.buyGood(o,1)&&Game.SparkleOn(e.target)}}(s)),AddEvent(l("bankGood-"+s+"_-1"),"click",function(o){return function(e){g.sellGood(o,1)&&Game.SparkleOn(e.target)}}(s)),AddEvent(l("bankGood-"+s+"_10"),"click",function(o){return function(e){g.buyGood(o,10)&&Game.SparkleOn(e.target)}}(s)),AddEvent(l("bankGood-"+s+"_-10"),"click",function(o){return function(e){g.sellGood(o,10)&&Game.SparkleOn(e.target)}}(s)),AddEvent(l("bankGood-"+s+"_100"),"click",function(o){return function(e){g.buyGood(o,100)&&Game.SparkleOn(e.target)}}(s)),AddEvent(l("bankGood-"+s+"_-100"),"click",function(o){return function(e){g.sellGood(o,100)&&Game.SparkleOn(e.target)}}(s)),AddEvent(l("bankGood-"+s+"_Max"),"click",function(o){return function(e){g.buyGood(o,1e4)&&Game.SparkleOn(e.target)}}(s)),AddEvent(l("bankGood-"+s+"_-All"),"click",function(o){return function(e){g.sellGood(o,1e4)&&Game.SparkleOn(e.target)}}(s));AddEvent(g.graph,"mousemove",function(e){var o=e.layerX,a=e.layerY,t=g.graph.width,i=g.graph.height,n=Math.max(4,Math.ceil(t/65)),s=-1,l=Math.ceil(t/n);e:for(var r=g.goodsById.length-1;0<=r;r--){var d=r,c=g.goodsById[d];if(!c.hidden&&c.active)for(var p=0;p<l;p++)if(c.vals.length>=2+p){var b=Math.max(c.vals[0+p],c.vals[1+p]),h=Math.abs(c.vals[0+p]-c.vals[1+p]);if(t-n*p-n-2<=o&&o<=t-n*p+2&&a>=i-b*g.graphScale-6&&a<=i-b*g.graphScale+Math.max(3,h*g.graphScale)+6){s=r,Game.tooltip.draw(0,'<div style="width:128px;font-size:10px;text-align:center;" id="tooltipMarketLine"><div class="icon" style="pointer-events:none;display:inline-block;transform:scale(0.5);margin:-16px -18px -16px -14px;vertical-align:middle;background-position:'+48*-c.icon[0]+"px "+48*-c.icon[1]+'px;"></div> <b>'+c.name.replace("%1",Game.bakeryName)+"</b><br>"+loc("valued at %1","<b>$"+Beautify(c.vals[0+p],2)+"</b>")+"<br>"+loc("%1 ago",Game.sayTime((p+1)*g.secondsPerTick*Game.fps))+"</div>","top");break e}}}s!=g.hoverOnGood&&(g.hoverOnGood=s,-1!=g.hoverOnGood?g.graph.style.cursor="pointer":(g.graph.style.cursor="auto",Game.tooltip.shouldHide=1),g.toRedraw=2)}),AddEvent(g.graph,"mouseout",function(e){g.graph.style.cursor="auto",-1!=g.hoverOnGood&&(g.hoverOnGood=-1,g.toRedraw=2),Game.tooltip.shouldHide=1}),g.reset()},g.onResize=function(){g.graph.width=l("bankContent").offsetWidth-22,g.graph.height=300;var e=g.graphCtx;e.fillStyle="#fff",e.fillRect(0,0,g.graph.width,g.graph.height),g.checkGraphScale(),g.toRedraw=2},g.save=function(){for(var e=parseInt(g.officeLevel)+":"+parseInt(g.brokers)+":"+parseInt(g.graphLines)+":"+parseFloat(g.profit)+":"+parseInt(g.graphCols)+": ",o=0;o<g.goodsById.length;o++){var a=g.goodsById[o];e+=parseInt(100*a.val)+":"+parseInt(a.mode)+":"+parseInt(100*a.d)+":"+parseInt(a.dur)+":"+parseInt(a.stock)+":"+parseInt(a.hidden?1:0)+":"+parseInt(a.last)+":"+parseInt(100*a.prev)+"!"}return e+(" "+parseInt(g.parent.onMinigame?"1":"0"))},g.load=function(e){if(!e)return!1;for(var o,a,t=0,t=(e=e.split(" "))[+t].split(":"),i=0,n=(g.officeLevel=Math.max(0,Math.min(parseInt(t[i++]||g.officeLevel),g.offices.length-1)),g.brokers=parseInt(t[i++]||g.brokers),g.graphLines=parseInt(t[+i]||g.graphLines),g.profit=parseFloat(t[3]||0),g.graphCols=parseInt(t[4]||g.graphCols),g.setCols(),g.tickT=0,e[1].split("!")),s=0;s<g.goodsById.length;s++)n[s]&&(o=g.goodsById[s],a=n[s].split(":"),o.val=parseInt(a[0])/100,o.mode=parseInt(a[1]),o.d=parseInt(a[2])/100,o.vals=[o.val,o.val-o.d],o.dur=parseInt(a[3]),o.stock=parseInt(a[4]),o.hidden=!!parseInt(a[5]),o.active=!1,o.last=parseInt(a[6]||0),o.prev=parseInt(a[7]||0)/100,0<o.building.highest&&(o.active=!0),o.l)&&g.updateGoodStyle(o.id);g.onResize(),parseInt(e[2]||0)&&1!=Game.ascensionMode&&g.parent.switchMinigame(1)},g.reset=function(e){g.tickT=0,g.toRedraw=0,g.officeLevel=0,g.brokers=0,e&&(g.graphLines=1,g.graphCols=0),g.setCols(),g.hoverOnGood=-1,g.ticks=0,g.lastTickDrawn=0;for(var o=g.profit=0;o<g.goodsById.length;o++){var a=g.goodsById[o];a.stock=0,a.mode=choose([0,1,1,2,2,3,4,5]),a.dur=Math.floor(10+690*Math.random()),a.val=g.getRestingVal(a.id),a.d=.2*Math.random()-.1,a.vals=[a.val,a.val-a.d],a.hidden=!0,a.active=!1,a.last=0,a.prev=0,a.l&&g.updateGoodStyle(a.id)}for(g.onResize(),o=0;o<15;o++)g.tick()},g.profit=0,g.ticks=0,g.lastTickDrawn=0,g.secondsPerTick=60,g.tick=function(){var e=Game.auraMult("Supreme Intellect"),o=0,a=Math.random();Math.random()<.1+.1*e&&(o=2*(Math.random()-.5));for(var t=0;t<g.goodsById.length;t++){var i=g.goodsById[t];i.last=0,i.d*=.97+.01*e,0==i.mode?(i.d*=.95,i.d+=.05*(Math.random()-.5)):1==i.mode?(i.d*=.99,i.d+=.05*(Math.random()-.1)):2==i.mode?(i.d*=.99,i.d-=.05*(Math.random()-.1)):3==i.mode?(i.d+=.15*(Math.random()-.1),i.val+=5*Math.random()):4==i.mode?(i.d-=.15*(Math.random()-.1),i.val-=5*Math.random()):5==i.mode&&(i.d+=.3*(Math.random()-.5)),i.val+=.01*(g.getRestingVal(i.id)-i.val),0!=o&&Math.random()<a&&(i.val-=(1+i.d*Math.pow(Math.random(),3)*7)*o,i.val-=o*(1+7*Math.pow(Math.random(),3)),i.d+=o*(1+4*Math.random()),i.dur=0),i.val+=3*Math.pow(2*(Math.random()-.5),11),i.d+=.1*(Math.random()-.5),Math.random()<.15&&(i.val+=3*(Math.random()-.5)),Math.random()<.03&&(i.val+=(Math.random()-.5)*(10+10*e)),Math.random()<.1&&(i.d+=(Math.random()-.5)*(.3+.2*e)),5==i.mode&&(Math.random()<.5&&(i.val+=10*(Math.random()-.5)),Math.random()<.2)&&(i.d=(Math.random()-.5)*(2+6*e)),3==i.mode&&Math.random()<.3&&(i.d+=.1*(Math.random()-.5),i.val+=10*(Math.random()-.7)),3==i.mode&&Math.random()<.03&&(i.mode=4),4==i.mode&&Math.random()<.3&&(i.d+=.1*(Math.random()-.5),i.val+=10*(Math.random()-.3)),i.val>100+3*(Game.Objects.Bank.level-1)&&0<i.d&&(i.d*=.9),i.val+=i.d,i.val<5&&(i.val+=.5*(5-i.val)),i.val<5&&i.d<0&&(i.d*=.95),i.val=Math.max(i.val,1),i.vals.unshift(i.val),65<i.vals.length&&i.vals.pop(),i.dur--,i.dur<=0&&(i.dur=Math.floor(10+Math.random()*(690-200*e)),Math.random()<e&&Math.random()<.5||Math.random()<.7&&(3==i.mode||4==i.mode)?i.mode=5:i.mode=choose([0,1,1,2,2,3,4,5]))}g.checkGraphScale(),g.toRedraw=Math.max(g.toRedraw,1),g.ticks++},g.dragonBoostTooltip=function(){return'<div style="width:280px;padding:8px;text-align:center;" id="tooltipDragonBoost"><b>'+loc("Supreme Intellect")+'</b><div class="line"></div>'+loc("The stock market is more chaotic.")+"</div>"},g.tickT=0,g.logic=function(){if(g.tickT++,g.tickT>=Game.fps*g.secondsPerTick&&(g.tickT=0,g.tick()),Game.T%10==0){for(var e=!1,o=0;o<g.goodsById.length;o++){var a=g.goodsById[o];!a.active&&0<a.building.highest&&(a.active=!0,a.hidden=!1,g.toRedraw=2,a.l)&&(g.updateGoodStyle(a.id),e=!0)}e&&g.onResize()}},g.hoverOnGood=-1,g.graphScale=10,g.graphLines=1,g.graphCols=0,g.checkGraphScale=function(){if(!(s=g.graph.height))return!1;for(var e=0,o=0;o<g.goodsById.length;o++){var a=g.goodsById[o];if(!a.hidden)for(var t=0;t<a.vals.length;t++)e=Math.max(e,a.vals[t])}var i=Math.max(e,10)+10,n=Math.max(1,s/i),s=(g.graphScale,s/g.graphScale-i);(g.graphScale!=n&&5<s||s<-5)&&(g.graphScale=n,g.toRedraw=2)},g.colBases=[{bg:"#fff",line1:"#eee",line2:"#ccc",low:"#ce2549",high:"#79c600",highlight:"#000"},{bg:"#1f2836",line1:"#273545",line2:"#384b61",low:"#3153a3",high:"#c4971a",highlight:"#a6abad"}],g.setCols=function(){g.colBases[g.graphCols]||(g.graphCols=0),g.cols=g.colBases[g.graphCols],l("bankGraphBox")&&(l("bankGraphBox").style.backgroundColor=g.cols.bg,l("bankGraphBox").style.color=g.cols.highlight),g.graph&&(g.graph.style.backgroundColor=g.cols.bg)},g.setCols(),g.drawGraph=function(e){for(var o=g.graphCtx,a=g.graph.width,t=Math.max(4,Math.ceil(a/65)),i=g.graph.height,n=(o.globalAlpha=1,e||o.drawImage(g.graph,-t,0),o.fillStyle=g.cols.bg,e?o.fillRect(0,0,a,i):o.fillRect(a-t,0,t,i),o.lineWidth=2,o.globalAlpha=1,e?Math.ceil(a/t):1),s=0;s<i/g.graphScale;s+=2)o.fillStyle=s%10!=0?g.cols.line1:g.cols.line2,o.fillRect(a-t*n,i-Math.floor(s*g.graphScale),t*n,1);for(var l=0;l<n;l++)(l-g.ticks)%10==0&&((l-g.ticks)%60!=0?o.fillStyle=g.cols.line1:o.fillStyle=g.cols.line2,o.fillRect(a-t*l-1,0,1,i));for(s=0;s<g.goodsById.length+1;s++){var r=s;if(s==g.goodsById.length)r=g.hoverOnGood;else if(s==g.hoverOnGood)continue;if(-1!=r){var d=g.goodsById[r];if(!d.hidden&&d.active)for(var c,p,b,h,m,l=0;l<n;l++)d.vals.length>=2+l&&(c=g.goodDelta(d.id,l),0==g.graphLines?(p=Math.max(d.vals[0+l],d.vals[1+l]),b=Math.abs(d.vals[0+l]-d.vals[1+l]),m=(h=Math.abs(Math.sin(11*(g.ticks-l)+137*r))*b*2)+Math.abs(Math.sin(13*(g.ticks-l)+139*r))*b*2,g.hoverOnGood==r&&(o.fillStyle=g.cols.highlight,o.fillRect(a-t*l-t-1,Math.floor(i-p*g.graphScale)-1,t+1,Math.max(3,Math.ceil(b*g.graphScale))+2)),o.fillStyle=0<c?g.cols.high:g.cols.low,o.fillRect(a-t*l-t,Math.floor(i-p*g.graphScale),t-1,Math.max(3,Math.ceil(b*g.graphScale))),o.fillRect(a-t*l-t/2-1,Math.floor(i-(p+h)*g.graphScale),1,Math.max(3,Math.ceil((b+m)*g.graphScale)))):(g.hoverOnGood==r&&(o.lineWidth=4,o.strokeStyle=g.cols.highlight,o.beginPath(),o.moveTo(a-t*l-t-1,Math.floor(i-d.vals[1+l]*g.graphScale)+.5),o.lineTo(a-t*l-1,Math.floor(i-d.vals[0+l]*g.graphScale)+.5),o.stroke(),o.lineWidth=2),o.strokeStyle=0<c?g.cols.high:g.cols.low,o.beginPath(),o.moveTo(a-t*l-t-1,Math.floor(i-d.vals[1+l]*g.graphScale)+.5),o.lineTo(a-t*l-1,Math.floor(i-d.vals[0+l]*g.graphScale)+.5),o.stroke()))}}},g.draw=function(){if(Game.drawT%2==0&&0<g.toRedraw&&g.graph&&g.graphCtx){g.lastTickDrawn<g.ticks-1&&(g.toRedraw=2),g.lastTickDrawn=g.ticks,g.drawGraph(2==g.toRedraw);for(var e=0;e<g.goodsById.length;e++){var o=g.goodsById[e],a=g.goodDelta(o.id);o.symbolNumL.innerHTML=a+""+(a==Math.floor(a)?".00":10*a==Math.floor(10*a)?"0":"")+"%",0<=a?(o.symbolNumL.classList.add("bankSymbolUp"),o.symbolNumL.classList.remove("bankSymbolDown")):a<0?(o.symbolNumL.classList.remove("bankSymbolUp"),o.symbolNumL.classList.add("bankSymbolDown")):(o.symbolNumL.classList.remove("bankSymbolUp"),o.symbolNumL.classList.remove("bankSymbolDown")),o.valL.innerHTML="$"+Beautify(o.val,2),o.stockL.innerHTML=Beautify(o.stock),0<o.stock?o.stockBoxL.classList.add("green"):o.stockBoxL.classList.remove("green"),o.stockMaxL.innerHTML="/"+Beautify(g.getGoodMaxStock(o)),o.graphIconL.style.transform="translate(-8px,"+Math.floor(g.graph.height-o.vals[0]*g.graphScale)+"px) scale(0.5)"}g.toRedraw=0}if(Game.drawT%10==0){var t=g.offices[g.officeLevel];l("bankOfficeIcon").style.backgroundPosition=48*-t.icon[0]+"px "+48*-t.icon[1]+"px",l("bankOfficeName").innerHTML=t.name,l("bankOfficeUpgrade").innerHTML=EN?"Upgrade ("+t.cost[0]+" cursors)":loc("Upgrade for %1",t.cost[0]+" "+Game.Objects.Cursor.plural),t.cost?(l("bankOfficeUpgrade").style.removeProperty("display"),Game.Objects.Cursor.amount>=t.cost[0]&&Game.Objects.Cursor.level>=t.cost[1]?l("bankOfficeUpgrade").classList.remove("bankButtonOff"):l("bankOfficeUpgrade").classList.add("bankButtonOff")):l("bankOfficeUpgrade").style.display="none",l("bankBrokersText").innerHTML=EN?0==g.brokers?"no brokers":1==g.brokers?"1 broker":g.brokers+" brokers":loc("Brokers:")+" "+g.brokers,g.brokers<g.getMaxBrokers()&&Game.cookies>=g.getBrokerPrice()?l("bankBrokersBuy").classList.remove("bankButtonOff"):l("bankBrokersBuy").classList.add("bankButtonOff"),g.officeLevel<=1?l("bankLoan1").style.display="none":l("bankLoan1").style.removeProperty("display"),g.officeLevel<=3?l("bankLoan2").style.display="none":l("bankLoan2").style.removeProperty("display"),g.officeLevel<=4?l("bankLoan3").style.display="none":l("bankLoan3").style.removeProperty("display");for(var i=1;i<4;i++)Game.hasBuff("Loan "+i)||Game.hasBuff("Loan "+i+" (interest)")?l("bankLoan"+i).classList.add("bankButtonOff"):l("bankLoan"+i).classList.remove("bankButtonOff");(t=l("bankBalance")).innerHTML=(g.profit<0?"-":"")+"$"+Beautify(Math.abs(g.profit),2),0<g.profit?(t.classList.add("bankSymbolUp"),t.classList.remove("bankSymbolDown")):g.profit<0&&(t.classList.add("bankSymbolDown"),t.classList.remove("bankSymbolUp")),l("bankNextTick").innerHTML=loc("Next tick in %1.",Game.sayTime(Game.fps*g.secondsPerTick-g.tickT+30,-1))}},g.init(l("rowSpecial"+g.parent.id))};var M=0;